---
title: "A Rmarkdown example with my awesome R code"
author: "José R. Ferrer-Paris"
date: "8 Dec 2023"
affiliation: 
 - "Centre for Ecosystem Science"
 - "UNSW codeRs"
format: html
---

## <a title="Dustin Curtis, CC0, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:Markdown-mark.svg"><img height="50" alt="Markdown-mark" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/48/Markdown-mark.svg/128px-Markdown-mark.svg.png"></a>

Markdown combines both the clear reading experience from word processor documents with the benefits of software code documents, which is both versatile and easy to use—even for people that only know how to operate Word or Writer.

At first, Markdown was basically a small script [John Gruber](https://daringfireball.net/projects/markdown/) wrote for himself in 2004 to yield these benefits. 

In 2012 a group of developers form [CommonMark](https://spec.commonmark.org/) to standardise Markdown into an internationally accepted norm.

## <a title="Rmarkdown documentation" href="https://rmarkdown.rstudio.com/docs/"><img height="75" alt="RMarkdown-logo" src="https://rmarkdown.rstudio.com/docs/reference/figures/logo.png"></a>

R Markdown documents are fully reproducible. Weave together narrative text written in markdown with executable code to produce elegantly formatted output.

You can create "Notebooks" that include chunks of code that can be executed independently and interactively, with output visible immediately beneath the input.

Or you can use Rmarkdown to render a final document showing code and/or outputs in different formats. 

You can use [multiple languages](https://bookdown.org/yihui/rmarkdown/language-engines.html) besides R: from [`awk`](https://en.wikipedia.org/wiki/AWK) to [`groovy`](https://groovy-lang.org/) and including `python`, and `sql`.


When you run render, R Markdown feeds the .Rmd file to knitr, which executes all of the code chunks and creates a new markdown (.md) document which includes the code and its output. The markdown file generated by knitr is then processed by pandoc which is responsible for creating the finished format.

![This is how Rmarkdown works](https://d33wubrfki0l68.cloudfront.net/61d189fd9cdf955058415d3e1b28dd60e1bd7c9b/b739c/lesson-images/rmarkdownflow.png)

## This is my great R code

### Load the libraries
We need `magick` to read the images, `ggplot2` for plotting and and `cowplot` for arranging the grid of plots and images.

```{r}
library(ggplot2)
library(cowplot)
library(magick)
```

### Locate the images
We use the functions from package `here` to establish our project root, and then use the relative paths to the images

```{r}
here::i_am("presentation/showcase-your-research.qmd")
yes_img <- here::here("images/yes.png")
no_img <- here::here("images/no.png")
```

We use functions from `cowplot` to set up drawing layers in top of blank `ggplot2` canvas. This requires the `magick` package to read and manipulate the images internally.

```{r}
yes_plot <- ggdraw() + draw_image(yes_img, scale = 1)
no_plot <- ggdraw() + draw_image(no_img, scale = 1)
```

### This is a bad plot
Sometimes we do silly mistakes when we are learning to use a package. This is one example:
```{r badplot, fig.cap='This is not the way to use the colour aesthetic'}
(bad_plot <- 
  ggplot(mpg, aes(x = displ, y = hwy, colour = "blue")) +
  geom_point())
```

### This is a good plot
Adding layers of `ggplot2` functions allow us to customise plots and make them ready for publication.

```{r goodplot, fig.cap="This plot is so nice!"}

(good_plot <- 
  ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(colour = "blue") +
  geom_smooth(colour = "red") + 
  theme_half_open(12) +
  labs(x = "Engine power (litres displ.)",
       y = "Fuel Efficiency (miles/gallon)"))
```


### Interactive plots with plotly

Now that we have a nice plot we are ready to make this plot interactive with plotly. 

First load the library:

```{r}
library(plotly)
```

And take one last steps:

```{r goodplotly, fig.cap="This was easy!"}
ggplotly(good_plot)
```


### Conclusion

This grid shows the progress from novice to expert in `ggplot2`

```{r meme}
plot_grid(no_plot, bad_plot,
          yes_plot, good_plot) 
```

